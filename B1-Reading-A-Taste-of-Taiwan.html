<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Taste of Taiwan - Interactive Lesson</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        html { scroll-behavior: smooth; }
        body { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }

        .worksheet-section { display: none; }
        .worksheet-section.active { display: block; animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Sidebar Navigation */
        .nav-item.active { background-color: #eef2ff; color: #3730a3; font-weight: 600; }
        .nav-item .icon-complete { opacity: 0; transition: opacity 0.3s; }
        .nav-item.completed .icon-complete { opacity: 1; }
        
        /* Feedback Styles */
        .correct { border-color: #22c55e !important; background-color: #f0fdf4 !important; }
        .incorrect { border-color: #ef4444 !important; background-color: #fef2f2 !important; }
        .correct-answer-text { color: #15803d; font-weight: 600; }
        .correct-radio + span { color: #16a34a; font-weight: bold; }
        .explanation { border-left: 4px solid #94a3b8; padding-left: 1rem; background-color: #f8fafc; }
        .input-wrapper { position: relative; display: inline-block; }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 antialiased">

    <div class="container mx-auto max-w-7xl p-4 sm:p-6 md:p-8">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
            <!-- Sidebar -->
            <aside class="md:col-span-1">
                <div class="sticky top-8 bg-white p-4 rounded-2xl shadow-lg">
                    <h2 class="text-xl font-bold text-slate-800 mb-4 text-center">Lesson Sections</h2>
                    <nav id="lesson-nav" class="space-y-2"></nav>
                    <div class="mt-6 text-center">
                        <button id="reset-all-btn" class="w-full bg-slate-200 text-slate-700 px-4 py-2 rounded-lg font-semibold hover:bg-slate-300 transition-colors text-sm">
                            Reset All Progress
                        </button>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="md:col-span-3">
                <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                    <!-- Header -->
                    <header class="text-center mb-8 pb-6 border-b border-slate-200">
                        <h1 class="text-3xl md:text-4xl font-bold text-slate-900">A Taste of Taiwan</h1>
                        <p class="text-slate-600 mt-2">An Interactive B1 Reading Lesson</p>
                    </header>

                    <!-- Part 1: Warm-up -->
                    <section id="warm-up" class="worksheet-section space-y-4">
                        <h2 class="text-2xl font-semibold text-slate-800 flex items-center"><span class="text-3xl mr-3">üó£Ô∏è</span> Warm-up Discussion</h2>
                        <p class="text-slate-600">Let's talk about your trip! Think about your answers to the questions below.</p>
                        <ul class="list-disc list-inside space-y-3 text-slate-700 pl-2">
                            <li>What was your favorite city or place you visited in Taiwan? Why?</li>
                            <li>Can you describe the most delicious food you ate there?</li>
                            <li>What was something that surprised you about the culture or the people?</li>
                            <li>If a friend asked you for one "must-do" activity in Taiwan, what would you recommend?</li>
                        </ul>
                    </section>
                    
                    <!-- Part 2: Vocabulary Matching -->
                    <section id="vocabulary" class="worksheet-section">
                        <h2 class="text-2xl font-semibold text-slate-800 flex items-center"><span class="text-3xl mr-3">üìù</span> Vocabulary Matching</h2>
                        <p class="text-slate-600 mb-6">Match the words with their correct definitions.</p>
                        <div id="vocab-container" class="space-y-4">
                            <!-- JS will render questions here -->
                        </div>
                        <div class="section-controls text-right mt-6"></div>
                    </section>

                    <!-- Part 3: Reading -->
                    <section id="reading" class="worksheet-section">
                        <h2 class="text-2xl font-semibold text-slate-800 flex items-center"><span class="text-3xl mr-3">üìñ</span> Reading</h2>
                        <article class="prose max-w-none mt-4 text-slate-700 leading-relaxed">
                            <h3 class="text-xl font-bold text-slate-900">My Unforgettable Weekend in Taipei</h3>
                            <p>Last month, I spent an amazing weekend exploring Taipei, the capital of Taiwan. From the moment I arrived, I was impressed by how clean and <strong>efficient</strong> the city was. The Metro system, known as the MRT, was fantastic. It was so easy to <strong>navigate</strong> the city and visit all the famous sights.</p>
                            <p>My first stop was Taipei 101, the famous <strong>landmark</strong> skyscraper. The elevator to the top was incredibly fast! From the observation deck on the 89th floor, the view of the entire city was breathtaking. You could see the mountains surrounding the city and the <strong>bustling</strong> streets below.</p>
                            <p>In the evening, I went to the Shilin Night Market. It was a completely different world! The market was so <strong>vibrant</strong>, filled with lights, sounds, and amazing smells. I walked past hundreds of food <strong>vendors</strong>, each selling delicious-looking snacks. I tried the famous stinky tofu, which has a very strong smell but tastes surprisingly good, and a huge fried chicken cutlet. It was a paradise for food lovers.</p>
                            <p>On my second day, I took a short train ride to Jiufen, an old town in the mountains. The <strong>scenery</strong> on the way was beautiful. Jiufen is famous for its narrow, winding streets, traditional teahouses, and red lanterns. It felt like stepping back in time. I bought a few small <strong>souvenirs</strong> for my family there, including some tasty pineapple cakes.</p>
                            <p>My weekend in Taipei was short but packed with wonderful experiences. The mix of modern city life and traditional culture is truly special. I can‚Äôt wait to go back and explore more of this beautiful island.</p>
                        </article>
                    </section>

                    <!-- Part 4: True or False -->
                    <section id="true-false" class="worksheet-section space-y-4">
                        <h2 class="text-2xl font-semibold text-slate-800 flex items-center"><span class="text-3xl mr-3">ü§î</span> True or False?</h2>
                        <p class="text-slate-600 mb-4">Read the statements and choose True or False.</p>
                        <div id="true-false-questions" class="space-y-4"></div>
                        <div class="section-controls text-right mt-4"></div>
                    </section>

                    <!-- Part 5: Summary Completion -->
                    <section id="summary-completion" class="worksheet-section space-y-4">
                        <h2 class="text-2xl font-semibold text-slate-800 flex items-center"><span class="text-3xl mr-3">‚úçÔ∏è</span> Summary Completion</h2>
                        <p class="text-slate-600 mb-4">Fill in the blanks to complete the summary. Use one word from the text for each blank.</p>
                        <div id="summary-cloze" class="text-slate-700 leading-relaxed bg-slate-50 p-4 rounded-lg"></div>
                         <div class="section-controls text-right mt-4"></div>
                    </section>

                    <!-- Part 6: Scenario Task -->
                    <section id="scenario" class="worksheet-section">
                         <h2 class="text-2xl font-semibold text-slate-800 flex items-center"><span class="text-3xl mr-3">‚úàÔ∏è</span> Scenario-based Task</h2>
                         <div class="mt-4 bg-blue-50 p-4 rounded-lg border border-blue-200">
                             <p class="font-semibold text-blue-800">Your Task:</p>
                             <p class="text-blue-700 mt-1">Imagine your teacher is planning a trip to Taiwan and has asked you for advice. Based on the reading text and <strong>your own recent trip</strong>, write a short email (80-100 words).</p>
                             <ul class="list-disc list-inside text-blue-700 mt-2 text-sm">
                                 <li>Recommend one place to visit that was in the article.</li>
                                 <li>Recommend one place or activity from your own experience.</li>
                                 <li>Explain why you recommend them.</li>
                             </ul>
                         </div>
                         <div class="mt-6">
                             <div class="bg-slate-100 p-2 rounded-t-lg text-sm text-slate-500 border-t border-x border-slate-300">
                                 To: Teacher | From: [Your Name] | Subject: My recommendations for your trip to Taiwan!
                             </div>
                             <textarea id="email-textarea" class="w-full h-64 p-4 border border-slate-300 rounded-b-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="Hi,&#10;&#10;I heard you are planning a trip to Taiwan! That's so exciting.&#10;&#10;..."></textarea>
                         </div>
                    </section>
                </div>
            </main>
        </div>
        <footer class="text-center mt-8 text-sm text-slate-500">
            <p>Designed by Fajarudin Akbar | <a href="https://fajarudinakbar.online" target="_blank" class="hover:underline text-blue-600">fajarudinakbar.online</a></p>
        </footer>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- DATA ---
    const sections = [
        { id: 'warm-up', name: 'Warm-up' },
        { id: 'vocabulary', name: 'Vocabulary' },
        { id: 'reading', name: 'Reading' },
        { id: 'true-false', name: 'True or False' },
        { id: 'summary-completion', name: 'Summary Completion' },
        { id: 'scenario', name: 'Scenario Task' }
    ];

    const vocabData = [
        { word: 'Bustling', answer: 'h' },
        { word: 'Efficient', answer: 'a' },
        { word: 'Scenery', answer: 'c' },
        { word: 'Vibrant', answer: 'f' },
        { word: 'Vendor', answer: 'g' },
        { word: 'Souvenir', answer: 'b' },
        { word: 'Landmark', answer: 'd' },
        { word: 'Navigate', answer: 'e' }
    ];

    const vocabDefinitions = [
        { id: 'a', text: 'Working well without wasting time or energy.' },
        { id: 'b', text: 'An object you buy to remember a place you visited.' },
        { id: 'c', text: 'The natural view of a landscape, like mountains or coastlines.' },
        { id: 'd', text: 'A famous building or place that is easy to recognize.' },
        { id: 'e', text: 'To find your way around a city or area.' },
        { id: 'f', text: 'Full of energy, life, and bright colors.' },
        { id: 'g', text: 'A person who sells things, often on the street.' },
        { id: 'h', text: 'Full of busy activity and people.' }
    ];
    
    const tfQuestionsData = [
        { q: "The writer thought the MRT system was difficult to use.", a: false, explanation: "The text says the MRT was 'fantastic' and 'easy to navigate'." },
        { q: "The writer only saw mountains from the top of Taipei 101.", a: false, explanation: "The text mentions seeing 'mountains' and the 'bustling streets below'." },
        { q: "The Shilin Night Market was quiet and calm.", a: false, explanation: "The market was described as 'vibrant, filled with lights, sounds, and amazing smells'." },
        { q: "The writer traveled to Jiufen by bus.", a: false, explanation: "The writer took a 'short train ride' to Jiufen." },
        { q: "Jiufen is a modern, new city.", a: false, explanation: "Jiufen is described as an 'old town' that felt like 'stepping back in time'." }
    ];
    
    const summaryData = [
        { text: "The writer found it easy to travel around Taipei using the (1) __BLANK__.", answer: "mrt", explanation: "The text says the Metro system, or MRT, was 'fantastic' and 'easy to navigate'." },
        { text: "From the top of the Taipei 101 skyscraper, there was a breathtaking (2) __BLANK__ of the city.", answer: "view", explanation: "The text describes the 'breathtaking view' from the observation deck." },
        { text: "The Shilin Night Market was filled with hundreds of food (3) __BLANK__ selling delicious snacks.", answer: "vendors", explanation: "The text mentions 'hundreds of food vendors' at the market." },
        { text: "The old town of Jiufen was famous for its traditional teahouses and red (4) __BLANK__.", answer: "lanterns", explanation: "The text states that Jiufen is famous for its 'red lanterns'." },
        { text: "For his family, the writer bought some pineapple cakes as a (5) __BLANK__.", answer: "souvenir", explanation: "The text says the writer bought 'a few small souvenirs', including pineapple cakes." }
    ];

    // --- STATE ---
    let currentSectionIndex = 0;
    const completedSections = new Set();
    
    // --- UI ELEMENTS ---
    const navContainer = document.getElementById('lesson-nav');
    const allSections = document.querySelectorAll('.worksheet-section');

    // --- NAVIGATION & VIEW MANAGEMENT ---
    function setupNavigation() {
        navContainer.innerHTML = '';
        sections.forEach((section, index) => {
            const navItem = document.createElement('a');
            navItem.href = '#';
            navItem.className = 'nav-item flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors hover:bg-slate-100';
            navItem.dataset.index = index;
            navItem.innerHTML = `
                <span>${index + 1}. ${section.name}</span>
                <span class="icon-complete text-green-500">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>
                </span>
            `;
            navItem.addEventListener('click', (e) => {
                e.preventDefault();
                currentSectionIndex = index;
                updateView();
            });
            navContainer.appendChild(navItem);
        });
    }
    
    function updateView() {
        allSections.forEach((sec, index) => {
            sec.classList.toggle('active', index === currentSectionIndex);
        });
        document.querySelectorAll('.nav-item').forEach((item, index) => {
            item.classList.toggle('active', index === currentSectionIndex);
            item.classList.toggle('completed', completedSections.has(index));
        });
        window.scrollTo(0, 0);
    }
    
    // --- RENDER FUNCTIONS ---
    function renderVocab() {
        const container = document.getElementById('vocab-container');
        container.innerHTML = '';

        const shuffledDefs = [...vocabDefinitions].sort(() => Math.random() - 0.5);
        const optionsHTML = shuffledDefs.map(def => `<option value="${def.id}">${def.id}. ${def.text}</option>`).join('');

        vocabData.forEach((item, index) => {
            container.innerHTML += `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center p-3 rounded-lg border border-slate-200 transition-colors">
                    <p class="font-medium text-slate-800">${index + 1}. ${item.word}</p>
                    <select data-index="${index}" class="vocab-select w-full p-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 transition">
                        <option value="">Select a definition...</option>
                        ${optionsHTML}
                    </select>
                </div>
            `;
        });
    }

    function renderTrueFalse() {
        const container = document.getElementById('true-false-questions');
        container.innerHTML = '';
        tfQuestionsData.forEach((item, index) => {
            container.innerHTML += `
                <div id="tf-q-${index}" class="p-4 rounded-lg border border-slate-200 transition-colors">
                    <p class="text-slate-700 mb-2">${index + 1}. ${item.q}</p>
                    <div class="flex space-x-6">
                        <label class="flex items-center space-x-2 cursor-pointer text-slate-600"><input type="radio" name="tf-${index}" value="true" class="form-radio"><span>True</span></label>
                        <label class="flex items-center space-x-2 cursor-pointer text-slate-600"><input type="radio" name="tf-${index}" value="false" class="form-radio"><span>False</span></label>
                    </div>
                    <div class="explanation mt-2 text-sm text-slate-600" style="display: none;"></div>
                </div>`;
        });
    }

    function renderSummary() {
        const container = document.getElementById('summary-cloze');
        container.innerHTML = '';
        const list = document.createElement('div');
        list.className = "space-y-4";
        
        summaryData.forEach((item, index) => {
            const itemDiv = document.createElement('div');
            itemDiv.id = `summary-q-${index}`;
            itemDiv.className = "transition-colors"; 

            const textWithInput = item.text.replace('__BLANK__', 
                `<span class="input-wrapper">
                    <input type="text" data-answer="${item.answer}" class="inline-block w-32 mx-1 px-2 py-1 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 transition">
                </span>`
            );

            itemDiv.innerHTML = `
                <p class="text-slate-700 leading-relaxed">${textWithInput}</p>
                <div class="explanation mt-2 text-sm text-slate-600" style="display: none;"></div>
            `;
            list.appendChild(itemDiv);
        });
        container.appendChild(list);
    }

    // --- CHECKING & FEEDBACK LOGIC ---
    function checkVocab(section) {
        let score = 0;
        resetStyles(section, true);
        section.querySelectorAll('.vocab-select').forEach((select) => {
            const index = parseInt(select.dataset.index);
            const isCorrect = select.value === vocabData[index].answer;
            const container = select.closest('.grid');

            container.classList.toggle('correct', isCorrect);
            container.classList.toggle('incorrect', !isCorrect);

            if (isCorrect) {
                score++;
            } else {
                const correctAnswerId = vocabData[index].answer;
                const correctDefinition = vocabDefinitions.find(def => def.id === correctAnswerId);
                const answerSpan = document.createElement('div');
                answerSpan.className = 'correct-answer-text mt-1 text-sm md:col-start-2';
                answerSpan.textContent = `(Correct: ${correctDefinition.id}. ${correctDefinition.text})`;
                container.appendChild(answerSpan);
            }
        });
        updateScore(section, score, vocabData.length);
    }

    function checkTrueFalse(section) {
        let score = 0;
        resetStyles(section, true);
        tfQuestionsData.forEach((item, index) => {
            const questionEl = section.querySelector(`#tf-q-${index}`);
            const selected = questionEl.querySelector(`input[name="tf-${index}"]:checked`);
            const isCorrect = selected && (JSON.parse(selected.value) === item.a);

            questionEl.classList.toggle('correct', isCorrect);
            questionEl.classList.toggle('incorrect', !isCorrect && selected);

            if (isCorrect) score++;
            
            const explanationDiv = questionEl.querySelector('.explanation');
            explanationDiv.textContent = `Explanation: ${item.explanation}`;
            explanationDiv.style.display = 'block';
        });
        updateScore(section, score, tfQuestionsData.length);
    }

    function checkSummary(section) {
        let score = 0;
        resetStyles(section, true);
        summaryData.forEach((item, index) => {
            const questionEl = section.querySelector(`#summary-q-${index}`);
            const input = questionEl.querySelector('input[type="text"]');
            const userAnswer = input.value.trim().toLowerCase();
            const isCorrect = userAnswer === item.answer;

            input.classList.toggle('correct', isCorrect);
            input.classList.toggle('incorrect', !isCorrect);

            if (isCorrect) {
                score++;
            } else {
                const answerSpan = document.createElement('span');
                answerSpan.className = 'correct-answer-text ml-1 text-sm';
                answerSpan.textContent = `(${item.answer})`;
                if (!input.closest('.input-wrapper').querySelector('.correct-answer-text')) {
                    input.closest('.input-wrapper').appendChild(answerSpan);
                }
            }
            
            const explanationDiv = questionEl.querySelector('.explanation');
            explanationDiv.textContent = `Explanation: ${item.explanation}`;
            explanationDiv.style.display = 'block';
        });
        updateScore(section, score, summaryData.length);
    }
    
    function updateScore(section, score, maxScore) {
        const controlsContainer = section.querySelector('.section-controls');
        const scoreContainer = controlsContainer.querySelector('.score-container');
        if (!scoreContainer) return;
        scoreContainer.textContent = `Score: ${score} / ${maxScore}`;
        scoreContainer.style.display = 'block';
        if (score === maxScore) {
            const sectionIndex = sections.findIndex(s => s.id === section.id);
            if (sectionIndex !== -1) {
                completedSections.add(sectionIndex);
            }
            updateView();
        }
    }

    // --- EVENT LISTENERS & SETUP ---
    function setupSection(sectionId, checkFn) {
        const section = document.getElementById(sectionId);
        if (!section) return;
        const controls = section.querySelector('.section-controls');
        if (!controls) return;

        controls.innerHTML = `
            <div class="score-container text-md font-bold text-slate-800 mb-2" style="display: none;"></div>
            <button class="check-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors shadow-md shadow-blue-500/20 text-sm">Check Answers</button>`;
        const checkButton = controls.querySelector('.check-btn');
        checkButton.addEventListener('click', () => {
            checkFn(section);
            checkButton.style.display = 'none';
        });
    }

    // --- RESET LOGIC ---
    function resetStyles(container, partial = false) {
        if (!container) return;
        
        const sectionEl = container.closest('.worksheet-section');
        const sectionIndex = sections.findIndex(s => s.id === sectionEl.id);

        if (!partial && sectionIndex !== -1) {
            completedSections.delete(sectionIndex);
            updateView();
        }
        
        container.querySelectorAll('.correct, .incorrect').forEach(el => el.classList.remove('correct', 'incorrect'));
        container.querySelectorAll('.correct-answer-text').forEach(el => el.remove());
        container.querySelectorAll('.correct-radio').forEach(el => el.classList.remove('correct-radio'));
        
        if (sectionEl) {
            sectionEl.querySelectorAll('.explanation').forEach(el => { el.style.display = 'none'; });
            const controls = sectionEl.querySelector('.section-controls');
            if(controls) {
                const scoreContainer = controls.querySelector('.score-container');
                if (scoreContainer) scoreContainer.style.display = 'none';
                const checkBtn = controls.querySelector('.check-btn');
                if (checkBtn) checkBtn.style.display = 'inline-flex';
            }
        }
    }

    function resetAll() {
        document.querySelectorAll('.worksheet-section').forEach(section => {
             section.querySelectorAll('input[type="radio"]').forEach(r => r.checked = false);
             section.querySelectorAll('input[type="text"]').forEach(i => i.value = '');
             section.querySelectorAll('select').forEach(s => s.selectedIndex = 0);
             resetStyles(section, true);
        });

        completedSections.clear();
        currentSectionIndex = 0;
        updateView();
    }
    
    document.getElementById('reset-all-btn').addEventListener('click', resetAll);

    // --- INITIALIZE ---
    setupNavigation();
    renderVocab();
    renderTrueFalse();
    renderSummary();
    
    setupSection('vocabulary', checkVocab);
    setupSection('true-false', checkTrueFalse);
    setupSection('summary-completion', checkSummary);
    
    updateView();
});
</script>
</body>
</html>

