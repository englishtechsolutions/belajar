<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B1 Reading/Speaking - Building a Shared Communication Culture</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .step {
            display: none;
        }
        .step.active {
            display: block;
        }
        .sidebar-link {
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }
        .sidebar-link.active {
            border-left-color: #4f46e5; /* indigo-600 */
            background-color: #eef2ff; /* indigo-50 */
            color: #4338ca; /* indigo-700 */
            font-weight: 600;
        }
        /* Correct/Incorrect styles for form elements */
        .correct-answer {
            border-color: #16a34a !important; /* green-600 */
            background-color: #f0fdf4 !important; /* green-50 */
            color: #15803d !important; /* green-700 */
        }
        .incorrect-answer {
            border-color: #dc2626 !important; /* red-600 */
            background-color: #fef2f2 !important; /* red-50 */
            color: #b91c1c !important; /* red-700 */
        }
        /* Correct/Incorrect styles for radio button containers */
        .tf-question.correct-answer {
            border-color: #16a34a; /* green-600 */
        }
        .tf-question.incorrect-answer {
            border-color: #dc2626; /* red-600 */
        }
        .correct-answer label {
             color: #15803d; /* green-700 */
        }
        .incorrect-answer label {
             color: #b91c1c; /* red-700 */
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="flex flex-col lg:flex-row min-h-screen bg-white">
        <!-- Sidebar -->
        <aside id="sidebar" class="w-full lg:w-1/4 bg-gray-50 border-b lg:border-r p-6 flex flex-col justify-between">
            <div>
                <h2 class="text-lg font-bold text-gray-800 mb-6">B1 Reading/Speaking</h2>
                <nav id="sidebar-nav" class="space-y-1">
                    <!-- Nav items will be injected by JS -->
                </nav>
            </div>
            <div class="text-center text-sm text-gray-500 mt-6">
                Designed by <a href="https://fajarudinakbar.online" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline">fajarudinakbar.online</a>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="flex-1">
            <div class="w-full max-w-4xl mx-auto">
                <header class="bg-white p-6 border-b">
                    <div class="flex justify-between items-center">
                        <h1 class="text-2xl font-bold text-gray-800">Building a Shared Communication Culture</h1>
                    </div>
                    <div id="main-header-progress" class="mt-4">
                        <!-- Main header progress will be injected by JS -->
                    </div>
                </header>

                <main class="p-6 sm:p-8">
                    <div id="worksheet-content">
                        <!-- Step 1: Warm-up -->
                        <div class="step active" data-step="1">
                            <h2 class="text-xl font-semibold text-gray-800 mb-4">Part 1: Warm-up Discussion</h2>
                            <div class="space-y-4 text-gray-700">
                                <p>Discuss the following questions with your student.</p>
                                <ol class="list-decimal list-inside space-y-3 pl-2">
                                    <li>When you work with people from other countries, what is the biggest communication challenge?</li>
                                    <li>Can you think of a time when a cultural difference caused a small misunderstanding at work?</li>
                                    <li>Why is it important for a manager to understand the cultural background of their team members?</li>
                                </ol>
                            </div>
                        </div>

                        <!-- Step 2: Vocabulary -->
                        <div class="step" data-step="2">
                            <h2 class="text-xl font-semibold text-gray-800 mb-4">Part 2: Vocabulary Matching</h2>
                            <p class="text-gray-700 mb-6">Choose the correct definition from the dropdown for each vocabulary word.</p>
                            <div id="vocab-matching-container" class="space-y-4">
                                <!-- Vocabulary items will be injected by JS -->
                            </div>
                            <div class="mt-6 flex items-center gap-4">
                                <button onclick="checkVocabAnswers()" class="bg-blue-600 text-white font-semibold py-2 px-5 rounded-lg hover:bg-blue-700 transition-colors">Check Answers</button>
                                <button onclick="resetVocab()" class="text-gray-600 hover:text-gray-900 font-semibold py-2 px-4 rounded-lg">Reset</button>
                                <p id="vocab-score" class="font-medium text-gray-700"></p>
                            </div>
                        </div>

                        <!-- Step 3: Reading -->
                        <div class="step" data-step="3">
                            <h2 class="text-xl font-semibold text-gray-800 mb-4">Part 3: Reading</h2>
                            <article class="prose max-w-none text-gray-700 space-y-4">
                                <h3 class="font-semibold text-gray-800">Different Ways of Working</h3>
                                <p>In the global business world, understanding cultural differences is key to success. For example, communication styles can vary greatly. In Germany, people often use direct communication. If a German manager says, "This tax report needs more details in section three," they mean exactly that. The feedback is clear, specific, and focused on the task. They value efficiency and clarity.</p>
                                <p>In contrast, in Japan, people often use indirect communication. A Japanese manager might say, "Perhaps we could review section three one more time to make it even stronger." The message is the same, but the delivery is softer to maintain group harmony. They often have a strong sense of hierarchy, so showing respect to senior colleagues is very important.</p>
                                <p>These differences can also be seen in attitudes toward punctuality. A manager from Switzerland might see arriving five minutes late to a meeting as unprofessional. However, a manager from Brazil might see relationships as more important than a strict schedule. Understanding these different attitudes helps build a team culture where everyone feels respected and can work together effectively.</p>
                            </article>
                        </div>

                        <!-- Step 4: Comprehension Checks -->
                        <div class="step" data-step="4">
                            <h2 class="text-xl font-semibold text-gray-800 mb-6">Part 4: Comprehension Checks</h2>
                            <!-- A. True or False -->
                            <div class="mb-8">
                                <h3 class="font-medium text-gray-700 mb-4">A. True or False?</h3>
                                <div id="true-false-questions" class="space-y-3">
                                    <!-- Questions injected by JS -->
                                </div>
                                <div class="mt-4 flex items-center gap-4">
                                    <button onclick="checkTrueFalse()" class="bg-blue-600 text-white font-semibold py-2 px-5 rounded-lg hover:bg-blue-700 transition-colors">Check Answers</button>
                                    <p id="tf-score" class="font-medium text-gray-700"></p>
                                </div>
                            </div>
                             <!-- B. Summary Fill-in-the-Blank -->
                            <div class="mb-8">
                                <h3 class="font-medium text-gray-700 mb-4">B. Summary Fill-in-the-Blank</h3>
                                <div id="summary-fill-in" class="p-5 bg-gray-50 rounded-lg text-gray-700 leading-relaxed">
                                    <!-- Summary text injected by JS -->
                                </div>
                                 <div class="mt-4 flex items-center gap-4">
                                    <button onclick="checkSummaryFill()" class="bg-blue-600 text-white font-semibold py-2 px-5 rounded-lg hover:bg-blue-700 transition-colors">Check Answers</button>
                                    <p id="summary-score" class="font-medium text-gray-700"></p>
                                </div>
                            </div>
                            <!-- C. Table Fill-in-the-Blank -->
                            <div>
                                <h3 class="font-medium text-gray-700 mb-4">C. Table Fill-in-the-Blank</h3>
                                <div id="table-fill-in" class="overflow-x-auto">
                                    <!-- Table injected by JS -->
                                </div>
                                 <div class="mt-4 flex items-center gap-4">
                                    <button onclick="checkTableFill()" class="bg-blue-600 text-white font-semibold py-2 px-5 rounded-lg hover:bg-blue-700 transition-colors">Check Answers</button>
                                    <p id="table-score" class="font-medium text-gray-700"></p>
                                </div>
                            </div>
                        </div>

                        <!-- Step 5: Speaking Task -->
                        <div class="step" data-step="5">
                            <h2 class="text-xl font-semibold text-gray-800 mb-4">Part 5: Scenario-Based Speaking Task</h2>
                            <div class="bg-blue-50 border-l-4 border-blue-500 p-5 rounded-r-lg mb-6">
                                <h3 class="font-semibold text-blue-800">Scenario</h3>
                                <p class="text-blue-900 mt-2">You are a tax manager in an international company. A new team member, Alex, has just joined your team from a different country. You want to have a welcome meeting to understand Alex's work style and explain your team's way of working. You want to make sure Alex feels comfortable and that you both have a clear understanding of each other's expectations.</p>
                            </div>
                            <div class="space-y-4 text-gray-700">
                                <p>Read the scenario and prepare to discuss the following questions.</p>
                                <ol class="list-decimal list-inside space-y-3 pl-2">
                                    <li>How would you start the conversation with Alex to make them feel welcome?</li>
                                    <li>What questions would you ask to understand Alex's attitude towards communication? (e.g., direct vs. indirect feedback)</li>
                                    <li>How would you explain your team's values regarding deadlines and punctuality?</li>
                                    <li>Imagine Alex says, "In my culture, it is rude to disagree with a manager." How would you respond to encourage open communication?</li>
                                    <li>How would you ask Alex about their experience with teamwork and collaboration?</li>
                                    <li>If your team communicates mostly by email, what advice would you give Alex about the team's email style?</li>
                                    <li>How would you describe the role of meetings in your team?</li>
                                    <li>What would you do if you noticed Alex was struggling to adapt to the team's communication style after a few weeks?</li>
                                    <li>How could you use this conversation to set goals with Alex for the first month?</li>
                                    <li>What final message would you give Alex to help build a shared communication culture?</li>
                                </ol>
                            </div>
                        </div>

                    </div>
                </main>
                
                <footer class="bg-gray-50 p-6 flex justify-between items-center border-t mt-8">
                    <button id="prev-btn" onclick="navigate(-1)" class="bg-gray-200 text-gray-700 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">Previous</button>
                    <button id="next-btn" onclick="navigate(1)" class="bg-indigo-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">Next</button>
                </footer>
            </div>
        </div>
    </div>

<script>
    // --- STATE & DATA ---
    let currentStep = 1;
    const totalSteps = 5;
    let vocabAttempts = 0;
    let trueFalseAttempts = 0;
    let summaryAttempts = 0;
    let tableAttempts = 0;

    const stepsData = [
        { section: "Prepare", title: "1. Warm-up Discussion" },
        { section: "Prepare", title: "2. Vocabulary Matching" },
        { section: "Do", title: "3. Reading" },
        { section: "Do", title: "4. Comprehension Checks" },
        { section: "Evaluate", title: "5. Scenario-Based Speaking Task" },
    ];

    const vocabulary = {
        terms: [
            { id: 1, term: "Direct communication", answer: "j" },
            { id: 2, term: "Indirect communication", answer: "g" },
            { id: 3, term: "Punctuality", answer: "i" },
            { id: 4, term: "Hierarchy", answer: "a" },
            { id: 5, term: "Culture", answer: "e" },
            { id: 6, term: "Value", answer: "c" },
            { id: 7, term: "Feedback", answer: "f" },
            { id: 8, term: "Adapt", answer: "b" },
            { id: 9, term: "Collaboration", answer: "d" },
            { id: 10, term: "Deadline", answer: "h" }
        ],
        definitions: [
            { id: "a", text: "A system where people are ranked one above the other according to status." },
            { id: "b", text: "To change your behavior to deal with a new situation." },
            { id: "c", text: "A belief about what is important in life." },
            { id: "d", text: "The act of working together with other people to achieve something." },
            { id: "e", text: "A set of shared beliefs and practices of a group of people." },
            { id: "f", text: "Information or criticism about someone's performance on a task." },
            { id: "g", text: "Expressing meaning through suggestion, context, and non-verbal cues." },
            { id: "h", text: "The time by which something must be finished." },
            { id: "i", text: "The quality of being on time." },
            { id: "j", text: "Saying exactly what you mean in a very clear way." }
        ]
    };

    const trueFalseData = [
        { q: "1. Direct communication is common in Japan.", a: false, ex: "The text states that in Japan, people often use <strong>indirect communication</strong> to maintain group harmony." },
        { q: "2. A German manager's feedback is usually very clear and specific.", a: true, ex: "Correct. The text says that German feedback is '<strong>clear, specific, and focused</strong> on the task.'" },
        { q: "3. Indirect communication focuses on maintaining group harmony.", a: true, ex: "Correct. The text mentions that the delivery of indirect communication is 'softer to <strong>maintain group harmony</strong>.'" },
        { q: "4. Attitudes toward punctuality are the same in every culture.", a: false, ex: "The text provides examples of <strong>different attitudes</strong> to punctuality in Switzerland and Brazil." },
        { q: "5. Understanding cultural differences is not important for a team's success.", a: false, ex: "The text explicitly states that 'understanding cultural differences is <strong>key to success</strong>' in the global business world." },
        { q: "6. In Germany, efficiency is a highly regarded value.", a: true, ex: "Correct. The text states that people in Germany 'value <strong>efficiency and clarity</strong>.'" },
        { q: "7. A Japanese manager's feedback might be less direct than a German manager's.", a: true, ex: "Correct. The text contrasts the 'direct' German style with the 'softer,' 'indirect' Japanese style." },
        { q: "8. The text suggests that hierarchy is not important in Japan.", a: false, ex: "The text states that in Japan, people 'often have a <strong>strong sense of hierarchy</strong>.'" },
        { q: "9. A manager from Switzerland likely values punctuality highly.", a: true, ex: "Correct. The text uses a Swiss manager as an example of someone who would see being late as <strong>unprofessional</strong>." },
        { q: "10. The main idea of the text is that all cultures communicate in the same way.", a: false, ex: "The main idea is the opposite; the text highlights that communication styles can '<strong>vary greatly</strong>' between cultures." }
    ];
    
    const summaryAnswers = { 1: "culture", 2: "direct", 3: "efficiency", 4: "feedback", 5: "indirect", 6: "harmony", 7: "hierarchy", 8: "respect", 9: "punctuality", 10: "values" };
    const tableAnswers = { 1: "Direct", 2: "Indirect", 3: "Efficiency", 4: "harmony", 5: "hierarchy", 6: "more details", 7: "review section three", 8: "task", 9: "respectful", 10: "culture" };


    // --- INITIALIZATION ---
    document.addEventListener('DOMContentLoaded', () => {
        setupSidebar();
        setupVocabMatching();
        setupTrueFalse();
        setupSummaryFill();
        setupTableFill();
        updateDisplay();
    });

    // --- SETUP FUNCTIONS ---
    function setupSidebar() {
        const nav = document.getElementById('sidebar-nav');
        let currentSection = "";
        stepsData.forEach((step, index) => {
            if (step.section !== currentSection) {
                currentSection = step.section;
                const sectionHeader = document.createElement('h3');
                sectionHeader.className = "text-xs font-semibold text-gray-500 uppercase tracking-wider mt-6 first:mt-0 px-3";
                sectionHeader.textContent = currentSection;
                nav.appendChild(sectionHeader);
            }
            const link = document.createElement('a');
            link.href = "#";
            link.className = "sidebar-link flex items-center p-3 rounded-md text-gray-600 hover:bg-gray-200";
            link.dataset.step = index + 1;
            link.innerHTML = `<span>${step.title}</span>`;
            link.onclick = (e) => {
                e.preventDefault();
                goToStep(index + 1);
            };
            nav.appendChild(link);
        });
    }

    function setupVocabMatching() {
        const container = document.getElementById('vocab-matching-container');
        const shuffledDefinitions = [...vocabulary.definitions].sort(() => Math.random() - 0.5);

        const optionsHTML = '<option value="">Select a definition...</option>' +
            shuffledDefinitions.map(def => `<option value="${def.id}">${def.id}. ${def.text}</option>`).join('');

        container.innerHTML = vocabulary.terms.map(item => `
            <div class="vocab-item grid grid-cols-1 md:grid-cols-2 gap-4 items-center" data-answer="${item.answer}">
                <p class="font-medium text-gray-800">${item.id}. ${item.term}</p>
                <select id="vocab-${item.id}" class="w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 transition-colors">
                    ${optionsHTML}
                </select>
            </div>
        `).join('');
    }
    
    function setupTrueFalse() {
        const container = document.getElementById('true-false-questions');
        container.innerHTML = trueFalseData.map((item, index) => `
            <div class="tf-question p-3 border-2 border-gray-200 rounded-lg transition-colors" data-answer="${item.a}">
                <p class="text-gray-800 mb-2">${item.q}</p>
                <div class="flex gap-4">
                    <label class="flex items-center gap-2 cursor-pointer"><input type="radio" name="tf-${index}" value="true" class="form-radio text-indigo-600 focus:ring-indigo-500"> True</label>
                    <label class="flex items-center gap-2 cursor-pointer"><input type="radio" name="tf-${index}" value="false" class="form-radio text-indigo-600 focus:ring-indigo-500"> False</label>
                </div>
                <div class="explanation hidden mt-2 p-3 bg-indigo-50 border-l-4 border-indigo-300 text-indigo-800 text-sm rounded-r-lg">
                    ${item.ex}
                </div>
            </div>
        `).join('');
    }

    function createStyledSelect(id, words) {
        const options = words.map(w => `<option value="${w.toLowerCase()}">${w}</option>`).join('');
        return `<select id="${id}" class="inline-block border border-gray-300 rounded-md py-1 px-2 mx-1 text-base shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 transition-colors"><option value="">Select...</option>${options}</select>`;
    }

    function setupSummaryFill() {
        const container = document.getElementById('summary-fill-in');
        const words = ["direct", "harmony", "culture", "values", "respect", "indirect", "hierarchy", "punctuality", "efficiency", "feedback"];
        const shuffledWords = [...words].sort(() => Math.random() - 0.5);
        container.innerHTML = `
            In the global workplace, it's vital to understand that each ${createStyledSelect('summary-1', shuffledWords)} has different norms.
            For instance, German businesspeople often prefer ${createStyledSelect('summary-2', shuffledWords)} communication because
            they value ${createStyledSelect('summary-3', shuffledWords)} and clarity. When they give ${createStyledSelect('summary-4', shuffledWords)}, it is clear and
            task-focused. In contrast, Japanese professionals often use ${createStyledSelect('summary-5', shuffledWords)} communication.
            Their goal is to maintain group ${createStyledSelect('summary-6', shuffledWords)}. They have a strong sense of ${createStyledSelect('summary-7', shuffledWords)},
            which means showing ${createStyledSelect('summary-8', shuffledWords)} to senior staff is crucial. Attitudes can also differ on
            topics like ${createStyledSelect('summary-9', shuffledWords)}. Recognizing these different ${createStyledSelect('summary-10', shuffledWords)} is the key to effective teamwork.`;
    }

    function setupTableFill() {
        const container = document.getElementById('table-fill-in');
        const createTableSelect = (id, options) => createStyledSelect(`table-${id}`, options);
        
        container.innerHTML = `
            <table class="w-full text-left border-collapse">
                <thead>
                    <tr class="bg-gray-100">
                        <th class="p-3 font-semibold text-sm text-gray-600 border-b">Cultural Aspect</th>
                        <th class="p-3 font-semibold text-sm text-gray-600 border-b">Germany</th>
                        <th class="p-3 font-semibold text-sm text-gray-600 border-b">Japan</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="border-b"><td class="p-3">Communication Style</td><td class="p-2">${createTableSelect(1, ["Direct", "Indirect", "Formal"])}</td><td class="p-2">${createTableSelect(2, ["Indirect", "Direct", "Informal"])}</td></tr>
                    <tr class="border-b"><td class="p-3">Primary Value</td><td class="p-2">${createTableSelect(3, ["Efficiency", "Harmony", "Punctuality"])} & Clarity</td><td class="p-2">Group ${createTableSelect(4, ["harmony", "efficiency", "clarity"])}</td></tr>
                    <tr class="border-b"><td class="p-3">Attitude to Hierarchy</td><td class="p-2">Not mentioned</td><td class="p-2">Strong sense of ${createTableSelect(5, ["hierarchy", "collaboration", "respect"])}</td></tr>
                    <tr class="border-b"><td class="p-3">Example Feedback</td><td class="p-2">"This report needs ${createTableSelect(6, ["more details", "a review", "some changes"])}"</td><td class="p-2">"Perhaps we could ${createTableSelect(7, ["review section three", "check the data", "improve the tone"])}"</td></tr>
                    <tr class="border-b"><td class="p-3">Likely Goal of Feedback</td><td class="p-2">To improve the ${createTableSelect(8, ["task", "relationship", "deadline"])}</td><td class="p-2">To be polite and ${createTableSelect(9, ["respectful", "direct", "efficient"])}</td></tr>
                </tbody>
            </table>
            <p class="mt-4 text-center text-gray-800">What is the overall goal? To build an effective team ${createTableSelect(10, ["culture", "project", "meeting"])}</p>`;
    }


    // --- NAVIGATION ---
    function navigate(direction) {
        let newStep = currentStep + direction;
        if (newStep > 0 && newStep <= totalSteps) {
            goToStep(newStep);
        }
    }

    function goToStep(stepNumber) {
        currentStep = stepNumber;
        updateDisplay();
    }

    function updateDisplay() {
        document.querySelectorAll('.step').forEach(step => {
            step.classList.remove('active');
            if (parseInt(step.dataset.step) === currentStep) {
                step.classList.add('active');
            }
        });

        document.getElementById('prev-btn').disabled = currentStep === 1;
        document.getElementById('next-btn').disabled = currentStep === totalSteps;

        document.querySelectorAll('#sidebar-nav .sidebar-link').forEach(link => {
            link.classList.toggle('active', parseInt(link.dataset.step) === currentStep);
        });

        const progressHeader = document.getElementById('main-header-progress');
        const currentStepData = stepsData[currentStep - 1];
        progressHeader.innerHTML = `
            <div class="flex justify-between items-center mb-2">
                <h3 class="text-lg font-semibold text-gray-700">${currentStepData.title}</h3>
                <p class="text-sm font-semibold text-gray-500">Step ${currentStep} of ${totalSteps}</p>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
                <div class="bg-indigo-600 h-2 rounded-full transition-all duration-300 ease-out" style="width: ${((currentStep)/(totalSteps)) * 100}%"></div>
            </div>
        `;
    }

    // --- VOCABULARY MATCHING LOGIC ---
    function checkVocabAnswers() {
        vocabAttempts++;
        let correctCount = 0;
        const items = document.querySelectorAll('.vocab-item');

        items.forEach(item => {
            const select = item.querySelector('select');
            const isCorrect = select.value === item.dataset.answer;
            select.classList.remove('correct-answer', 'incorrect-answer');

            if (isCorrect) {
                select.classList.add('correct-answer');
                correctCount++;
            } else {
                select.classList.add('incorrect-answer');
                if (vocabAttempts >= 2) {
                    select.value = item.dataset.answer;
                    select.classList.remove('incorrect-answer');
                    select.classList.add('correct-answer');
                }
            }
        });
        
        if (vocabAttempts >= 2) correctCount = vocabulary.terms.length;

        const scoreEl = document.getElementById('vocab-score');
        scoreEl.textContent = `Score: ${correctCount} / ${vocabulary.terms.length}`;
        if (vocabAttempts >= 2) {
            scoreEl.textContent += ' (Answers shown)';
        }
    }

    function resetVocab() {
        vocabAttempts = 0;
        document.getElementById('vocab-score').textContent = '';
        document.querySelectorAll('.vocab-item select').forEach(select => {
            select.value = "";
            select.classList.remove('correct-answer', 'incorrect-answer');
        });
    }

    // --- COMPREHENSION CHECK LOGIC ---
    function checkTrueFalse() {
        trueFalseAttempts++;
        let correctCount = 0;
        const questions = document.querySelectorAll('.tf-question');
        questions.forEach((q) => {
            q.classList.remove('correct-answer', 'incorrect-answer');
            const selected = q.querySelector('input:checked');
            const isCorrect = selected && selected.value === q.dataset.answer;

            if (isCorrect) {
                q.classList.add('correct-answer');
                correctCount++;
            } else {
                q.classList.add('incorrect-answer');
                if (trueFalseAttempts >= 2) {
                    if (selected) selected.checked = false;
                    const correctAnswerInput = q.querySelector(`input[value="${q.dataset.answer}"]`);
                    if (correctAnswerInput) {
                        correctAnswerInput.checked = true;
                        q.classList.remove('incorrect-answer');
                        q.classList.add('correct-answer');
                    }
                }
            }
            if (trueFalseAttempts >= 2) {
                const explanationEl = q.querySelector('.explanation');
                if (explanationEl) explanationEl.classList.remove('hidden');
            }
        });
        if (trueFalseAttempts >= 2) correctCount = trueFalseData.length;
        document.getElementById('tf-score').textContent = `Score: ${correctCount} / ${trueFalseData.length}`;
    }

    function checkAnswerAndShow(type, attempts, answers, total) {
        let correctCount = 0;
        for (let i = 1; i <= total; i++) {
            const select = document.getElementById(`${type}-${i}`);
            select.classList.remove('correct-answer', 'incorrect-answer');
            const isCorrect = select.value.trim().toLowerCase() === answers[i].toLowerCase();
            
            if (isCorrect) {
                select.classList.add('correct-answer');
                correctCount++;
            } else {
                select.classList.add('incorrect-answer');
                if (attempts >= 2) {
                    select.value = answers[i].toLowerCase();
                    select.classList.remove('incorrect-answer');
                    select.classList.add('correct-answer');
                }
            }
        }
        if (attempts >= 2) correctCount = total;
        document.getElementById(`${type}-score`).textContent = `Score: ${correctCount} / ${total}`;
        return attempts;
    }

    function checkSummaryFill() {
        summaryAttempts++;
        summaryAttempts = checkAnswerAndShow('summary', summaryAttempts, summaryAnswers, 10);
    }

    function checkTableFill() {
        tableAttempts++;
        tableAttempts = checkAnswerAndShow('table', tableAttempts, tableAnswers, 10);
    }
</script>
</body>
</html>
